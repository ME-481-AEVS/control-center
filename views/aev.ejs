<%- include('components/head') %>
<%- include('components/navbar') %>

<head>
    <style>
      body {
        background-color: #111111;
      }
      @keyframes blinker {
        50% {
          opacity: 75%;
        }
      }
      #status-box {
        padding-top: 8px;
        padding-bottom: 8px;
        background-color: #1e1e1e;
        color: #0f9d3c;
        border-radius: 10px;
      }
      .info-box {
        padding-top: 14px;
        padding-bottom: 14px;
        background-color: #1e1e1e;
        color: #d9d9d9;
        border-radius: 10px;
      }
      .btn {
        border-radius: 0;
      }
      .row {
        --bs-gutter-x: 0;
      }
      .video-embed {
        position: relative;
        max-width: 100%;
        max-height: 100%;
        pointer-events: none;
      }
      .front_camera {
        margin: 0 -50%;
        object-position: 50% 50%;
        clip-path: inset(0 0 0 50%);
        height: 90%;
        object-fit: contain;
        scale: 200%;
        overflow: hidden;
        z-index: -1;
      }
      .other_camera {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }
      .small {
        font-size: 10px;
      }
      .text-overlay-main {
        position: absolute;
        width: 150px;
        top: 10px;
        right: 45%;
        background-color: black;
        color: white;
        font-size: 25px;
        font-weight: bold;
        padding: 5px;
        opacity: 50%;
      }
      .text-overlay {
        position: absolute;
        top: 10px;
        right: 45%;
        background-color: black;
        color: white;
        font-weight: bold;
        padding: 5px;
        font-size: 14px;
        opacity: 50%;
      }
      .dot {
        height: 20px;
        width: 20px;
        background-color: #0f9d3c;
        border-radius: 50%;
        display: inline-block;
      }
    </style>
</head>

<body>
<div class="row" style="height: calc(100vh - 58px);">
    <div class="col-lg-9 text-center" >
        <div class="row video-embed" style="height: calc(70vh - 30px)">
            <span class="text-overlay-main">FRONT</span>
            <video id="frontCam" class="front_camera" autoplay playsinline muted></video>
        </div>
        <div class="row" style="height: calc(30vh - 32px);">
            <div class="col video-embed">
                <span class="text-overlay">LEFT</span>
            </div>
            <div class="col video-embed">
                <span class="text-overlay">REAR</span>
                <img class="other_camera" src="http://168.105.255.185:5000/rear"/>
            </div>
            <div class="col video-embed">
                <span class="text-overlay">RIGHT</span>
            </div>
        </div>
    </div>
    <div class="col-lg-3 text-center d-flex flex-column justify-content-between" style="height: 100%">
        <div id="status-box" class="row mt-2">
            <div class="col">
                <div class="row align-items-center text-center">
                    <div class="col-2">
                        <div id="statusCircle" class="dot ms-3 mt-1"></div>
                    </div>
                    <div class="col">
                        <b id="statusText">Ready</b>
                    </div>
                    <div class="col-2">
                    </div>
                </div>
            </div>
        </div>
        <div id="currentDeliveryBox" class="row info-box">
            <b>Current Delivery</b>
            <div class="row">
                <div class="col">
                    <div class="row small">
                        <span>From</span>
                    </div>
                    <div class="row">
                        <b>Homles Hall</b>
                    </div>
                </div>
                <div class="col">
                    <div class="row small">
                        <span>To</span>
                    </div>
                    <div class="row">
                        <b>Hamilton</b>
                    </div>
                </div>
            </div>
            <div class="row mt-2">
                <div class="col">
                    <div class="row small">
                        <span>User</span>
                    </div>
                    <div class="row">
                        <b>J. Schmoe</b>
                    </div>
                </div>
                <div class="col">
                    <div class="row small">
                        <span>Progress</span>
                    </div>
                    <div class="row">
                        <b>53%</b>
                    </div>
                </div>
            </div>
        </div>
        <div id="manualControlBox" class="row info-box" style="display: none;">
            <b>Manual Controls</b>
            <div class="row mt-2 px-2">
                <div id="forwardControl" class="col">
                    <div class="row small">
                        <span>Forward</span>
                    </div>
                    <div class="row">
                        <b>W</b>
                    </div>
                </div>
                <div id="leftControl" class="col">
                    <div class="row small">
                        <span>Left</span>
                    </div>
                    <div class="row">
                        <b>A</b>
                    </div>
                </div>
                <div id="backControl" class="col">
                    <div class="row small">
                        <span>Backward</span>
                    </div>
                    <div class="row">
                        <b>S</b>
                    </div>
                </div>
                <div id="rightControl" class="col">
                    <div class="row small">
                        <span>Right</span>
                    </div>
                    <div class="row">
                        <b>D</b>
                    </div>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col">
                    <button type="button" onclick="openDoor()" class="btn btn-dark" style="width: 100%;"><b>Open Door</b></button>
                </div>
                <div class="col">
                    <button type="button" onclick="closeDoor()" class="btn btn-dark" style="width: 100%;"><b>Close Door</b></button>
                </div>
            </div>
        </div>
        <div class="row info-box">
            <b>Telemetry</b>
            <div class="row">
                <div class="col">
                    <div class="row small">
                        <span>Battery</span>
                    </div>
                    <div class="row">
                        <b id="batteryPercent">59%</b>
                    </div>
                </div>
                <div class="col">
                    <div class="row small">
                        <span>Door Status</span>
                    </div>
                    <div class="row">
                        <b id="doorStatus">Closed</b>
                    </div>
                </div>
            </div>
            <div class="row mt-2">
                <div class="col">
                    <div class="row small">
                        <span>Speed</span>
                    </div>
                    <div class="row">
                        <b id="speed">0 mph</b>
                    </div>
                </div>
                <div class="col">
                    <div class="row small">
                        <span>Accelerometer</span>
                    </div>
                    <div class="row">
                        <b id="accelerometer">0.0, 0.0, 0.0</b>
                    </div>
                </div>
            </div>
            <div class="row mt-2">
                <div class="col">
                    <div class="row small">
                        <span>Bolt Lock</span>
                    </div>
                    <div class="row">
                        <b>Engaged</b>
                    </div>
                </div>
                <div class="col">
                    <div class="row small">
                        <span>Brakes</span>
                    </div>
                    <div class="row">
                        <b>Powered</b>
                    </div>
                </div>
            </div>
            <div class="row mt-2">
                <div class="col">
                    <div class="row small">
                        <span>CPU</span>
                    </div>
                    <div class="row">
                        <b>28°C</b>
                    </div>
                </div>
                <div class="col">
                    <div class="row small">
                        <span>Elec Bay</span>
                    </div>
                    <div class="row">
                        <b id="ebTemp">22°C</b>
                    </div>
                </div>
            </div>
            <div class="row mt-2">
                <div class="col">
                    <div class="row small">
                        <span>Wi-Fi</span>
                    </div>
                    <div class="row">
                        <b>Strong</b>
                    </div>
                </div>
                <div class="col">
                    <div class="row small">
                        <span>GPS</span>
                    </div>
                    <div class="row">
                        <b>Medium</b>
                    </div>
                </div>
            </div>
        </div>
        <div>
            <div class="row">
                <button id="manualControlButton" type="button" onclick="manualControl()" class="btn btn-warning justify-content-center" style="font-weight: 700; font-size: 1.4rem;">
                    MANUAL CONTROL
                </button>
            </div>
            <div class="row">
                <button id="emergencyStopButton" onclick="toggleEmergencyStop()" type="button" class="btn btn-danger justify-content-center" style="font-weight: 600; font-size: 1.4rem;">
                    EMERGENCY STOP
                </button>
            </div>
        </div>
    </div>
    <script src="/scripts/remoteCommands.js"></script>
    <script src="/scripts/updateTelem.js"></script>
    <script src="/scripts/webrtc.js"></script>
</div>
</body>

